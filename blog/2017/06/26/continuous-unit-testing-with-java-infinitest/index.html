<!doctype html><html lang=en><head><title>Continuous unit testing with Java & Infinitest :: Nick Ebbitt</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="As my awareness around automated testing, and particularly TDD, has risen over the last few years I&amp;rsquo;ve been keeping my ear to the ground for new ideas and techniques I can experiment with.
I was recently at a meetup hosted by Equal Experts and there was a talk by Oliver Shaw on what &amp;ldquo;Doing TDD&amp;rdquo; is, and isn&amp;rsquo;t. The talk provided a great live demo of TDD exploring a fairly simple use-case but showing how natural the TDD process can be."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://www.nickebbitt.com/blog/2017/06/26/continuous-unit-testing-with-java-infinitest/><link rel=stylesheet href=https://www.nickebbitt.com/styles.css><link rel="shortcut icon" href=https://www.nickebbitt.com/img/theme-colors/orange.png><link rel=apple-touch-icon href=https://www.nickebbitt.com/img/theme-colors/orange.png><meta name=twitter:card content="summary"><meta name=twitter:site content="nickebbitt"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Continuous unit testing with Java & Infinitest"><meta property="og:description" content="As my awareness around automated testing, and particularly TDD, has risen over the last few years I&amp;rsquo;ve been keeping my ear to the ground for new ideas and techniques I can experiment with.
I was recently at a meetup hosted by Equal Experts and there was a talk by Oliver Shaw on what &amp;ldquo;Doing TDD&amp;rdquo; is, and isn&amp;rsquo;t. The talk provided a great live demo of TDD exploring a fairly simple use-case but showing how natural the TDD process can be."><meta property="og:url" content="https://www.nickebbitt.com/blog/2017/06/26/continuous-unit-testing-with-java-infinitest/"><meta property="og:site_name" content="Nick Ebbitt"><meta property="og:image" content="https://www.nickebbitt.com/img/favicon/orange.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2017-06-26 00:00:00 +0000 UTC"></head><body class=orange><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/posts><div class=logo>Nick Ebbitt</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About</a></li><li><a href=/contact>Contact</a></li><li><a href=/posts>Posts</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About</a></li><li><a href=/contact>Contact</a></li><li><a href=/posts>Posts</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://www.nickebbitt.com/blog/2017/06/26/continuous-unit-testing-with-java-infinitest/>Continuous unit testing with Java & Infinitest</a></h1><div class=post-meta><time class=post-date>2017-06-26 ::</time></div><div class=post-content><div><p>As my awareness around automated testing, and particularly TDD, has risen over the last few years I&rsquo;ve been keeping my ear to the ground for new ideas and techniques I can experiment with.</p><p>I was recently at a <a href=https://www.meetup.com/Expert-Talks-Manchester/events/238434029/>meetup</a> hosted by Equal Experts and there was a talk by <a href=https://twitter.com/olly_shaw>Oliver Shaw</a> on what &ldquo;Doing TDD&rdquo; is, and isn&rsquo;t. The talk provided a great live demo of TDD exploring a fairly simple use-case but showing how natural the TDD process can be. The demo was done using Scala and he used Vim as his IDE which was impressive and very effective.</p><p>The relevance to this post is that he was using an <a href=http://www.scala-sbt.org/>SBT</a> task (<a href=http://www.scala-sbt.org/0.13/docs/Testing.html#testQuick><code>~test-quick</code></a>) to continuously watch for file changes and automatically run the unit tests against them when they changed. This allowed him to remain focused on the code and the cycles involved in TDD rather than breaking flow through repeatedly having to manually run the tests.</p><p>I like the idea of this! Anything that can help to keep focus and make the process more efficient is worth a try.</p><h2 id=what-is-continuous-unit-testing>What is continuous unit testing?<a href=#what-is-continuous-unit-testing class=hanchor arialabel=Anchor>&#8983;</a></h2><p><em>Continuous unit testing</em> is basically the idea that every time you make a change to your code, be that functional or test code, the tests that are associated with that change will automatically run. This is not be confused with <a href=https://en.wikipedia.org/wiki/Continuous_testing>Continuous Testing</a> as part of a build pipeline.</p><blockquote><p><em>Continuous unit testing</em> tools or frameworks use the concept of a <em>test watcher</em>.</p></blockquote><p>The <em>test watcher</em> runs in the background and watches for changes on the source files you are working on. When a file changes the <em>test watcher</em> triggers the execution of any related tests automatically.</p><p>The standard TDD cycle, as per <a href=https://en.wikipedia.org/wiki/Test-driven_development#Test-driven_development_cycle>Wikipedia</a>, is:</p><ul><li>Add a test</li><li>Run all tests to see if the new test fails</li><li>Write the code</li><li>Run tests</li><li>Refactor code</li><li>Repeat</li></ul><p>Using a <em>continuous unit testing</em> approach, the cycle becomes:</p><ul><li>Add a test <em>(tests run automatically and see new test fail)</em></li><li>Write the code <em>(tests run automatically and hopefully see all tests pass)</em></li><li>Refactor <em>(tests run automatically and hopefully continue to see all tests pass)</em></li><li>Repeat</li></ul><p>Each time the <em>tests run automatically</em>, any failures are brought to the developers attention to be dealt with immediately. A fix can be applied, or the change that caused the failure reverted, at which point the tests automatically run again until you eventually get to the position of all tests passing.</p><p>The <em>continuous unit testing</em> approach has reduced the number of steps (not including <em>Repeat</em>) in the TDD cycle from 5 to 3.</p><p>Some benefits of this are:</p><ul><li>reduced context switching due to not having to manually run the tests</li><li>shorter cycles (feedback loops) between making a change and finding if a test has passed, or failed</li></ul><p>There are various tools available depending on your language of choice. The natural choice for Scala is likely SBT as mentioned above. This can also be used for Java based projects however another option that integrates with my IDE of choice, IntelliJ, is <a href=https://infinitest.github.io/>Infinitest</a>.</p><h2 id=infinitest>Infinitest<a href=#infinitest class=hanchor arialabel=Anchor>&#8983;</a></h2><p><em>Infinitest</em> provides plugins for both Eclipse and IntelliJ. We will look at how it works with IntelliJ for the purposes of this post.</p><p>The project&rsquo;s website describes what <em>Infinitest</em> does very nicely:</p><blockquote><p>Each time a change is made on the source code, Infinitest runs all the tests that might fail because of these changes.</p></blockquote><p>The <a href=http://infinitest.github.io/doc/user_guide.html>documentation</a> is pretty brief but from my experience it covers everything you need to know to get started and configure it in various ways.</p><h3 id=intellij-setup>IntelliJ Setup<a href=#intellij-setup class=hanchor arialabel=Anchor>&#8983;</a></h3><p>The first thing to do is install the plugin in IntelliJ. It can be found easily by searching the plugin repos.</p><p>Once the plugin is installed, it needs to be configured for your project. This is achieved by adding a <em>facet</em> to the project. Navigate to the <em>Project Structure</em> view in IntelliJ (<code>⌘;</code> on MacOS), select <em>Facets</em> and click the add (<code>+</code>) button. Select <em>Infinitest</em> from the list and associate it with the module(s) in your project that you want <em>Infinitest</em> to run against.</p><p><img src=infinitest-facet.png alt="Infinitest facet"></p><p>A new tool window should now be visible in the bottom panel of your IDE that indicates that <em>Infinitest</em> is watching for changes.</p><p><img src=infinitest-window-start.png alt="Infinitest window start"></p><p>If configuring <em>Infinitest</em> for a brand new project the window will be empty as there won&rsquo;t yet be any tests. When adding <em>Infinitest</em> to an existing project the window may also be empty as <em>Infinitest</em> will only react to changes when the files you are changing are compiled.</p><blockquote><p>To support the continuous unit testing process, it makes sense to enable the &ldquo;compile on save&rdquo; feature in your IDE to ensure that the tests run automatically.</p></blockquote><p>In IntelliJ this means enabling the feature to <a href=https://www.mkyong.com/intellij/intellij-idea-how-to-build-project-automatically/><em>build the project automatically</em></a>.</p><p>Let&rsquo;s write a failing test and take a another look at the window.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>thisFails</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>   assertEquals<span style=color:#f92672>(</span><span style=color:#ae81ff>1</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>On saving the test file, the <em>Infinitest</em> window automatically refreshes, we see red and details of the test failure.</p><p><img src=infinitest-window-failure.png alt="Infinitest window failure"></p><p>Fixing the test and saving causes the window to automatically refresh again and we see green.</p><p><img src=infinitest-window-passing.png alt="Infinitest window passing"></p><p>That&rsquo;s it, you&rsquo;re good to go with your continuous unit testing setup.</p><h3 id=more-on-test-failures>More on test failures<a href=#more-on-test-failures class=hanchor arialabel=Anchor>&#8983;</a></h3><p>When a test fails you obviously want to understand why and fix it as soon as possible.</p><p>Double clicking the failure in the <em>Infinitest</em> window will take you straight to the line of code that caused the test to fail, usually an assertion but possibly an exception.</p><p>In addition to this, <em>Infinitest</em> will highlight the line of code that is failing by adding its icon to the side panel. Hovering over the icon will display the reason the test failed. Nice.</p><p><img src=infinitest-failure-icon.png alt="Infinitest failure icon"></p><h3 id=filtering-tests>Filtering tests<a href=#filtering-tests class=hanchor arialabel=Anchor>&#8983;</a></h3><p>In many applications, there will be a mix of tests of different styles such as unit, integration and load. In general, it is unlikely you will want to automatically want run integration or load tests every time a file changes that they depend on due to them being slow running or requiring more complex external setup.</p><p><em>Infinitest</em> provides the ability to filter tests for this exact reason. Simply adding an <code>infinitest.filters</code> file to the root of your project and adding regular expressions (one per line) will filter out the tests that match.</p><p>A simple example to filter out integration tests, assuming they have names such as <code>MyAppIT</code>, is to create a file with the following content:</p><p><code>.*IT</code></p><p>Filters can also be applied to packages using a regex such as:</p><p><code>com\.nickebbitt\.it\..*</code></p><p>If using <a href=http://testng.org/doc/>TestNG</a> rather than <a href=http://junit.org/junit4/>JUnit</a> there is also the option to filter tests using TestNG groups.</p><hr><p>To summarise, if you are following a TDD approach and are looking to shorten the cycles, or even just writing unit tests and want quicker feedback, then following a continuous unit testing approach can help achieve this.</p><p>If you&rsquo;re developing in Java and using IntelliJ, or Eclipse, then <em>Infinitest</em> is your friend. It&rsquo;s simple to setup and provides exactly the features you need to start continuously unit testing on your projects.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://www.nickebbitt.com/blog/2017/07/31/reading-a-file-in-java-8/><span class=button__icon>←</span>
<span class=button__text>Reading a file in Java 8</span></a></span>
<span class="button next"><a href=https://www.nickebbitt.com/blog/2017/04/16/looking-forward-to-junit-5/><span class=button__text>Looking forward to JUnit 5</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2023 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>